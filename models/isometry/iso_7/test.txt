name  : isometry/iso_7 # isometry/kyles_TEMP # isometry/iso_6 # jacobian/vanilla # jacobian/jac_2
model : 00030.pt # baseline.pt # 00030.pt
reg_type : isometry # isometry # jacobian
gpu_number : None
seed  : 1

train      : True
load       : False
adv_train  : False
adv_test   : False
distill    : False
reg        : True

# model

channels1 : 32
channels2 : 64
hidden    : 128

# data

input_shape : (1, 28, 28)
num_classes : 10

# training

epochs          : 30
batch_size      : 64
test_batch_size : 64
learning_rate   : 0.001

distill_temp : 20

# eps_inf = 0.3 => eps_l2 = sqrt(784)*eps_inf = 28*0.3 = 8.4
# eps_inf = 0.2 => eps_l2 = sqrt(784)*eps_inf = 28*0.2 = 5.6
epsilon   : 5.6
eta_min   : 0.0001
eta_max   : 0.0001
epoch_reg : 1

verbose      : True
log_interval : 100
save_step    : 1

# testing

testing_batch_size : 128
test_epoch         : 30
loader             : test

# attack

attack_type       : fgsm # fgsm # pgd # deep_fool # cw
perturbation_type : linf # pgd only does Linf, deep_fool only does L2
budget            : 0.2
alpha             : 0.01
max_iter          : 40
random_start      : True


------------------------------------------------------------------------------------------------------


### epoch 28

## light_train

# budget : 0.1

Using cpu
Using testing batch size for test loader
Using testing batch size for train loader
Loading weights
Initialization done
Start testing
Using light train loader
Min Linf norm: 0.10000002384185791
Test: 0/1000 (0%)	Loss: 1.561058, Cross Entropy: 1.561058, Reg: 0.000000
Elapsed time (s): 4.523680925369263
Memory usage (GB): 0.4961280822753906
Min Linf norm: 0.10000002384185791
Min Linf norm: 0.10000002384185791
Test: 256/1000 (25%)	Loss: 1.592625, Cross Entropy: 1.592625, Reg: 0.000000
Elapsed time (s): 8.245424747467041
Memory usage (GB): 0.6325111389160156
Min Linf norm: 0.10000002384185791
Min Linf norm: 0.10000002384185791
Test: 512/1000 (50%)	Loss: 1.577083, Cross Entropy: 1.577083, Reg: 0.000000
Elapsed time (s): 9.517330884933472
Memory usage (GB): 0.6790885925292969
Min Linf norm: 0.10000002384185791
Min Linf norm: 0.10000002384185791
Test: 768/1000 (75%)	Loss: 1.561491, Cross Entropy: 1.561491, Reg: 0.000000
Elapsed time (s): 8.360166549682617
Memory usage (GB): 0.6964607238769531
Min Linf norm: 0.10000002384185791
Test set: Average loss: 1.5703, Average cross entropy: 1.5703, Average reg: 0.0000, Accuracy: 889/1000 (89%), Robust accuracy: 516/889 (58%)

# budget : 0.2

Using cpu
Using testing batch size for test loader
Using testing batch size for train loader
Loading weights
Initialization done
Start testing
Using light train loader
Min Linf norm: 0.20000000298023224
Test: 0/1000 (0%)	Loss: 1.561058, Cross Entropy: 1.561058, Reg: 0.000000
Elapsed time (s): 4.474685192108154
Memory usage (GB): 0.4984474182128906
Min Linf norm: 0.20000000298023224
Min Linf norm: 0.20000000298023224
Test: 256/1000 (25%)	Loss: 1.592625, Cross Entropy: 1.592625, Reg: 0.000000
Elapsed time (s): 8.230573654174805
Memory usage (GB): 0.6347389221191406
Min Linf norm: 0.20000000298023224
Min Linf norm: 0.20000000298023224
Test: 512/1000 (50%)	Loss: 1.577083, Cross Entropy: 1.577083, Reg: 0.000000
Elapsed time (s): 8.256794691085815
Memory usage (GB): 0.6815681457519531
Min Linf norm: 0.20000000298023224
Min Linf norm: 0.20000000298023224
Test: 768/1000 (75%)	Loss: 1.561491, Cross Entropy: 1.561491, Reg: 0.000000
Elapsed time (s): 8.220530271530151
Memory usage (GB): 0.6989402770996094
Min Linf norm: 0.20000000298023224
Test set: Average loss: 1.5703, Average cross entropy: 1.5703, Average reg: 0.0000, Accuracy: 889/1000 (89%), Robust accuracy: 152/889 (17%)

# budget : 0.3

Using cpu
Using testing batch size for test loader
Using testing batch size for train loader
Loading weights
Initialization done
Start testing
Using light train loader
Min Linf norm: 0.30000001192092896
Test: 0/1000 (0%)	Loss: 1.561058, Cross Entropy: 1.561058, Reg: 0.000000
Elapsed time (s): 4.152692794799805
Memory usage (GB): 0.545166015625
Min Linf norm: 0.30000001192092896
Min Linf norm: 0.30000001192092896
Test: 256/1000 (25%)	Loss: 1.592625, Cross Entropy: 1.592625, Reg: 0.000000
Elapsed time (s): 7.930699586868286
Memory usage (GB): 0.6056060791015625
Min Linf norm: 0.30000001192092896
Min Linf norm: 0.30000001192092896
Test: 512/1000 (50%)	Loss: 1.577083, Cross Entropy: 1.577083, Reg: 0.000000
Elapsed time (s): 8.023045301437378
Memory usage (GB): 0.6973342895507812
Min Linf norm: 0.30000001192092896
Min Linf norm: 0.30000001192092896
Test: 768/1000 (75%)	Loss: 1.561491, Cross Entropy: 1.561491, Reg: 0.000000
Elapsed time (s): 8.227648258209229
Memory usage (GB): 0.6973342895507812
Min Linf norm: 0.30000001192092896
Test set: Average loss: 1.5703, Average cross entropy: 1.5703, Average reg: 0.0000, Accuracy: 889/1000 (89%), Robust accuracy: 76/889 (9%)

