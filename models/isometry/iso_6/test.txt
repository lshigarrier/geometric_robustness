name  : isometry/iso_6 # isometry/kyles_TEMP
model : 00030.pt # baseline.pt
reg_type : isometry # isometry # jacobian
gpu_number : None
seed  : 1

train      : False
load       : True
adv_train  : False
adv_test   : True
distill    : False
reg        : False

# model

channels1 : 32
channels2 : 64
hidden    : 128

# data

input_shape : (1, 28, 28)
num_classes : 10

# training

epochs          : 30
batch_size      : 64
test_batch_size : 64
learning_rate   : 0.001

distill_temp : 20

# eps_inf = 0.3 => eps_l2 = sqrt(784)*eps_inf = 28*0.3 = 8.4
# eps_inf = 0.2 => eps_l2 = sqrt(784)*eps_inf = 28*0.2 = 5.6
epsilon   : 5.6
eta_min   : 0.0001
eta_max   : 0.0001
epoch_reg : 1

verbose      : True
log_interval : 10
save_step    : 1

# testing

testing_batch_size : 128
test_epoch         : 30
loader             : test

# attack

attack_type       : fgsm # fgsm # deep_fool # cw
perturbation_type : linf # deep_fool only does L2
alpha             : 0.01
max_iter          : 40

------------------------------------------------------------------------------------------------------

# budget : 0.1

Using cpu
Using testing batch size for test loader
Using testing batch size for train loader
Loading weights
Initialization done
Start testing
Using test loader
Test: 0/10000 (0%)	Loss: 1.596673, Cross Entropy: 1.596673, Reg: 0.000000
Elapsed time (s): 3.3883144855499268
Memory usage (GB): 0.5991783142089844
Test: 1280/10000 (13%)	Loss: 1.565155, Cross Entropy: 1.565155, Reg: 0.000000
Elapsed time (s): 35.529125928878784
Memory usage (GB): 0.7964363098144531
Test: 2560/10000 (25%)	Loss: 1.552796, Cross Entropy: 1.552796, Reg: 0.000000
Elapsed time (s): 34.98088312149048
Memory usage (GB): 0.8452301025390625
Test: 3840/10000 (38%)	Loss: 1.656913, Cross Entropy: 1.656913, Reg: 0.000000
Elapsed time (s): 35.43130016326904
Memory usage (GB): 0.8462371826171875
Test: 5120/10000 (51%)	Loss: 1.551996, Cross Entropy: 1.551996, Reg: 0.000000
Elapsed time (s): 34.26447677612305
Memory usage (GB): 0.8289413452148438
Test: 6400/10000 (63%)	Loss: 1.588439, Cross Entropy: 1.588439, Reg: 0.000000
Elapsed time (s): 35.933385133743286
Memory usage (GB): 0.8966178894042969
Test: 7680/10000 (76%)	Loss: 1.558439, Cross Entropy: 1.558439, Reg: 0.000000
Elapsed time (s): 36.032954931259155
Memory usage (GB): 0.8804969787597656
Test: 8960/10000 (89%)	Loss: 1.574278, Cross Entropy: 1.574278, Reg: 0.000000
Elapsed time (s): 35.770663022994995
Memory usage (GB): 0.88043212890625
Test set: Average loss: 1.5676, Average cross entropy: 1.5676, Average reg: 0.0000, Accuracy: 8899/10000 (89%), Robust accuracy: 7785/8899 (87%)

# budget : 0.2

Using cpu
Using testing batch size for test loader
Using testing batch size for train loader
Loading weights
Initialization done
Start testing
Using test loader
Test: 0/10000 (0%)	Loss: 1.596673, Cross Entropy: 1.596673, Reg: 0.000000
Elapsed time (s): 3.3932461738586426
Memory usage (GB): 0.5673484802246094
Test: 1280/10000 (13%)	Loss: 1.565155, Cross Entropy: 1.565155, Reg: 0.000000
Elapsed time (s): 35.60052037239075
Memory usage (GB): 0.7656822204589844
Test: 2560/10000 (25%)	Loss: 1.552796, Cross Entropy: 1.552796, Reg: 0.000000
Elapsed time (s): 35.23949980735779
Memory usage (GB): 0.8787384033203125
Test: 3840/10000 (38%)	Loss: 1.656913, Cross Entropy: 1.656913, Reg: 0.000000
Elapsed time (s): 35.37093687057495
Memory usage (GB): 0.87982177734375
Test: 5120/10000 (51%)	Loss: 1.551996, Cross Entropy: 1.551996, Reg: 0.000000
Elapsed time (s): 34.44128441810608
Memory usage (GB): 0.87982177734375
Test: 6400/10000 (63%)	Loss: 1.588439, Cross Entropy: 1.588439, Reg: 0.000000
Elapsed time (s): 36.073740005493164
Memory usage (GB): 0.8992080688476562
Test: 7680/10000 (76%)	Loss: 1.558439, Cross Entropy: 1.558439, Reg: 0.000000
Elapsed time (s): 35.89573884010315
Memory usage (GB): 0.8641777038574219
Test: 8960/10000 (89%)	Loss: 1.574278, Cross Entropy: 1.574278, Reg: 0.000000
Elapsed time (s): 35.80924844741821
Memory usage (GB): 0.8799324035644531
Test set: Average loss: 1.5676, Average cross entropy: 1.5676, Average reg: 0.0000, Accuracy: 8899/10000 (89%), Robust accuracy: 7535/8899 (85%)

# budget : 0.3

Using cpu
Using testing batch size for test loader
Using testing batch size for train loader
Loading weights
Initialization done
Start testing
Using test loader
Test: 0/10000 (0%)	Loss: 1.596673, Cross Entropy: 1.596673, Reg: 0.000000
Elapsed time (s): 3.3883216381073
Memory usage (GB): 0.5592498779296875
Test: 1280/10000 (13%)	Loss: 1.565155, Cross Entropy: 1.565155, Reg: 0.000000
Elapsed time (s): 36.05318093299866
Memory usage (GB): 0.7834739685058594
Test: 2560/10000 (25%)	Loss: 1.552796, Cross Entropy: 1.552796, Reg: 0.000000
Elapsed time (s): 35.33838152885437
Memory usage (GB): 0.8484916687011719
Test: 3840/10000 (38%)	Loss: 1.656913, Cross Entropy: 1.656913, Reg: 0.000000
Elapsed time (s): 35.4158148765564
Memory usage (GB): 0.8983421325683594
Test: 5120/10000 (51%)	Loss: 1.551996, Cross Entropy: 1.551996, Reg: 0.000000
Elapsed time (s): 34.48051953315735
Memory usage (GB): 0.8983421325683594
Test: 6400/10000 (63%)	Loss: 1.588439, Cross Entropy: 1.588439, Reg: 0.000000
Elapsed time (s): 35.94216585159302
Memory usage (GB): 0.8985939025878906
Test: 7680/10000 (76%)	Loss: 1.558439, Cross Entropy: 1.558439, Reg: 0.000000
Elapsed time (s): 35.65744066238403
Memory usage (GB): 0.8985939025878906
Test: 8960/10000 (89%)	Loss: 1.574278, Cross Entropy: 1.574278, Reg: 0.000000
Elapsed time (s): 35.55085825920105
Memory usage (GB): 0.8985939025878906
Test set: Average loss: 1.5676, Average cross entropy: 1.5676, Average reg: 0.0000, Accuracy: 8899/10000 (89%), Robust accuracy: 7535/8899 (85%)


